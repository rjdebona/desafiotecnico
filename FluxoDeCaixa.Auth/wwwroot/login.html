<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Fluxo de Caixa - Login</title>
</head>
<body>
  <h1>Login (FluxoDeCaixa Auth)</h1>
  <form id="login" action="#">
    <label>Username <input id="username" value="admin" /></label><br/>
    <label>Password <input id="password" type="password" value="password" /></label><br/>
    <button type="submit">Login</button>
  </form>
  <pre id="result"></pre>
<script>
document.getElementById('login').addEventListener('submit', async function(e){
  e.preventDefault();
  const u = document.getElementById('username').value;
  const p = document.getElementById('password').value;
  const res = await fetch('/auth/token', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ username: u, password: p }) });
  const txt = document.getElementById('result');
  if (!res.ok) { txt.textContent = 'Login failed: ' + res.status; return; }
  const body = await res.json();
  const token = body.token;
  // set cookie for this domain
  document.cookie = 'fluxo_token=' + token + '; path=/';
  txt.textContent = 'Logged in, token set as cookie.';
});
</script>
</body>
</html>
